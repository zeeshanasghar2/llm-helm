apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: azure-kv-secrets
  namespace: openwebui-stack
spec:
  provider: azure
  parameters:
    useWorkloadIdentity: "true"
    keyvaultName: "dev-llm-keyvault"
    clientID: "155978dc-ecfd-4bf1-8221-d4c9e3509f14" # Managed Identity Client ID
    tenantId: "1a20a08a-cff0-479f-87e5-e4027d22cdbc" # Managed Identity Tenant ID
    objects: |
      array:
        - |
          objectName: postgresql-admin-password
          objectType: secret
          objectAlias: POSTGRES_PASSWORD
        - |
          objectName: postgresql-admin-username
          objectType: secret
          objectAlias: POSTGRES_USER
        - |
          objectName: postgresql-database
          objectType: secret
          objectAlias: POSTGRES_DB
        - |
          objectName: postgresql-host
          objectType: secret
          objectAlias: POSTGRES_HOST
        - |
          objectName: postgresql-port
          objectType: secret
          objectAlias: POSTGRES_PORT
        - |
          objectName: webui-secret-key
          objectType: secret
          objectAlias: WEBUI_SECRET_KEY
        - |
          objectName: litellm-master-key
          objectType: secret
          objectAlias: LITELLM_MASTER_KEY